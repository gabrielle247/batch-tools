#!/bin/bash
# Fees-Up Linux Development Launcher
# Automatically runs the Flutter app on Linux desktop

set -e

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘           FEES-UP FLUTTER APP - LINUX DEVELOPMENT             â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Get the directory where this script is located
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd "$SCRIPT_DIR"

echo "ğŸ“ Project Directory: $SCRIPT_DIR"
echo ""

# Check if environment file exists
if [ ! -f "assets/keys.env" ]; then
    echo "âš ï¸  Warning: assets/keys.env not found"
    echo "   The app may not connect to Supabase without environment variables."
    echo ""
fi

# Load environment variables if they exist
if [ -f "assets/keys.env" ]; then
    export $(cat assets/keys.env | grep -v '^#' | xargs)
    echo "âœ… Environment variables loaded from assets/keys.env"
else
    echo "âš ï¸  No environment file found. Using defaults..."
fi

echo ""
echo "ğŸš€ Starting Flutter app on Linux..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Run Flutter with proper flags for Linux
flutter run \
  -d linux \
  --dart-define=SUPABASE_URL="${SUPABASE_URL}" \
  --dart-define=SUPABASE_ANON_KEY="${SUPABASE_ANON_KEY}" \
  --dart-define=ENVIRONMENT=development

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ›‘ App closed"
